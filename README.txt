Please don't judge me for this code, I'm desperate and tired.